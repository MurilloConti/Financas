<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
        crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Exo" rel="stylesheet">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue2-filters/dist/vue2-filters.min.js"></script>
    <title>DashBoard</title>
    <style>
        .cardHeader {
            background: #00796B;
            color: #ffffff;
            font-weight: bold
        }
        .cardCorpo
        {
            /* background: #424242; */
            color: #ffffff;
        }
    </style>
</head>

<body style="font-family: 'Exo', sans-serif; background: #f1f1f1">
    <div id="app">
        <div class="container">
            <ul class="nav nav-tabs">
                <li class="nav-item">
                    <a class="nav-link active" href="#">Visão geral</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Cartao</a>
                </li>
            </ul>
            <div class="row mt-3">
                <div class="col">
                    <div class="card text-center cardCorpo">
                        <div class="card-header cardHeader">
                            Patrimonio total
                        </div>
                        <div class="card-body">
                            <p style="font-size: 22px" class="card-text">0</p>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="card text-center cardCorpo">
                        <div class="card-header cardHeader">
                            Lucro no mês {{ new Date().getMonth() + 1 }}/{{ new Date().getFullYear() }}
                        </div>
                        <div class="card-body">
                            <p style="font-size: 22px" class="card-text"></p>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="card text-center cardCorpo">
                        <div class="card-header cardHeader">
                            Ganho em relação ultimo periodo {{ new Date().getMonth()  }}/{{ new Date().getFullYear() }}
                        </div>
                        <div class="card-body">
                            <p style="font-size: 22px" class="card-text">{{this.total}}</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-6">
                    <div class="card cardCorpo">
                        <div class="card-header cardHeader">
                            Evolução de patrimonio
                        </div>
                        <div class="card-body">
                            <div id="chart_div"></div>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="card cardCorpo">
                        <div class="card-header cardHeader">
                            Distribuição de recursos
                        </div>
                        <div class="card-body">
                            <div id="chart_div2"></div>                            
                        </div>
                    </div>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col">
                    <div class="card text-center cardCorpo">
                        <div class="card-header cardHeader">
                            Desempenho de fundos
                        </div>
                        <div class="card-body">
                                <table class="table table-light" style="font-size: 0.8rem">
                                        <thead>
                                            <tr>
                                                <th scope="col">Status</th>
                                                <th scope="col">Fundo</th>                                                
                                                <th scope="col">Valorização</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><i></i></td>
                                                <td>Daycoval Debêntures Incentiva FIM C Priv</td>                                                                                                
                                                <td>3.25%</td>
                                            </tr>
                                        </tbody>
                                    </table>                           
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="card text-center cardCorpo">
                        <div class="card-header cardHeader">
                            Lucro no mês
                        </div>
                        <div class="card-body">
                            <p style="font-size: 22px" class="card-text">R$20.000,00</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-xl" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Ocorrencias por cliente no periodo</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body" style="max-height: 80vh; overflow-y: scroll">
                        <table class="table table-light">
                            <thead>
                                <tr>
                                    <th scope="col">Codigo</th>
                                    <th scope="col">Cliente</th>
                                    <th scope="col">Tp Ocorrencia</th>
                                    <th scope="col">Ocorrencias</th>
                                    <th scope="col">Tot.Tx. Netpag</th>
                                    <th scope="col">Tot.Tx. banco</th>
                                    <th scope="col">Tot. Recebido</th>
                                </tr>
                            </thead>
                            <tbody v-for="items in orderBy(this.info, 'TotRecebidoNetPag',-1)">
                                <tr>
                                    <td>{{items.CodCli}}</td>
                                    <td>{{items.Cliente}}</td>
                                    <td>{{items.DescrTpOcorrencia}}</td>
                                    <td>{{items.Ocorrencias}}</td>
                                    <td>{{items.TotTaxasNetdente | currency('R$', 2, { decimalSeparator: ',' })}}</td>
                                    <td>{{items.TotTaxasBanco | currency('R$', 2, { decimalSeparator: ',' })}}</td>
                                    <td>{{items.TotRecebidoNetPag | currency('R$', 2, { decimalSeparator: ',' })}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script type="text/javascript">

    //Load the Visualization API and the corechart package.
    google.charts.load('current', { 'packages': ['corechart'] });

    // google.charts.setOnLoadCallback(drawChart);

    function drawChart(arr) {            
            var data2 = new google.visualization.DataTable();
            data2.addColumn('string', 'Fundo');
            data2.addColumn('number', 'Valor');
            data2.addRows([
                ['Daycoval Debêntures Incentiva FIM C Priv', 83719.88],
                ['LCI/DAYCOVAL 97.5%', 38191.19],
                ['LCI/DAYCOVAL 100%', 9291.02],
                ['Constância Fundamento FIA', 10181.65],
                ['Daycoval Ibovespa Ativo FIA', 16417.96],
                ['LCI Banco do Brasil', 0],
                [' BP Debêntures Incentiv 45 FIC FIM C Priv', 0],
            ]);
            var options2 = { 'height': 300 };
            var data = new google.visualization.DataTable();
            data.addColumn('string', 'Ano/Mes');
            data.addColumn('number', 'Valor');
            data.addRows(arr);
            var options = { 'height': 300, colors: ['#00C853'], };
            var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
            chart.draw(data, options);
            var chart2 = new google.visualization.PieChart(document.getElementById('chart_div2'));
            chart2.draw(data2, options2);
        }
</script>
<script>
    new Vue({
        el: '#app',
        data() {
            return {
                info: {},
                total: 1,
                EvolBaixas:{}
            }
        },
        created: function () {
            axios
                .get('https://localhost:5001/rendimentos/evolucao')
                .then(function (response) {                                     
                    this.drawChart(response.data);
                }.bind(this))
                .catch(error => console.log(error));      
                axios
                .get('https://localhost:5001/rendimentos/total')
                .then(function (response) {                                     
                    console.log(response);
                    this.total = response.data;
                }.bind(this))
                .catch(error => console.log(error));              
        },        
        computed: {
              
        },
        methods: {
            TotalLucro: () => {
                console.log(this.total);
                return this.total;
            },         
            drawChart: (resp) => {                
               
                var arr = [];
                resp.forEach(element => {          
                    var item = [element.DiaMes, element.Total]                              
                    arr.push(item);
                });                
                drawChart(arr);
            }
        },
        mixins: [Vue2Filters.mixin],
    })
</script>

</html>